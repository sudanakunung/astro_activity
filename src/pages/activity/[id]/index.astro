---
import Layout from '../../../layouts/Layout.astro';
import "../../../styles/global.css";
import romantic from '../../../data/romantic-experiences.json';
// Ticket data (rendered server-side). Replace with real data source when available.
const tickets = [
  {
    id: 'weekday-package',
    name: 'Jatim Park 1 + Museum Tubuh + Museum Angkut Weekday',
    price: 'IDR 180.000',
    features: [
      'Access to Jatim Park 1',
      'Access to Museum Tubuh',
      'Access to Museum Angkut',
      'Valid Monday - Friday',
    ],
    href: '/activity/jatim-park-weekday',
  },
  {
    id: 'weekend-package',
    name: 'Jatim Park 1 + Museum Tubuh + Museum Angkut Weekend',
    price: 'IDR 200.000',
    features: [
      'Access to Jatim Park 1',
      'Access to Museum Tubuh',
      'Access to Museum Angkut',
      'Valid Saturday, Sunday & Public Holidays',
    ],
    href: '/activity/jatim-park-weekend',
  },
  {
    id: 'angkut-weekend',
    name: 'Jatim Park 1 + Museum Angkut Weekend',
    price: 'IDR 170.000',
    features: [
      'Access to Jatim Park 1',
      'Access to Museum Angkut',
      'Valid Saturday, Sunday & Public Holidays',
    ],
    href: '/activity/jatim-park-angkut-weekend',
  },
  {
    id: 'angkut-weekday',
    name: 'Jatim Park 1 + Museum Angkut Weekday',
    price: 'IDR 150.000',
    features: [
      'Access to Jatim Park 1',
      'Access to Museum Angkut',
      'Valid Monday - Friday',
    ],
    href: '/activity/jatim-park-angkut-weekday',
  },
];
// Example static paths for activity pages. Replace with real data source when available.
export async function getStaticPaths() {
  const ids = romantic.items.map(item => item.slug);

  return ids.map((id) => ({ params: { id } }));
}
const current = romantic.items.find(item => item.slug === Astro.params.id) || null;
---

<Layout>
  <div class="container mx-auto px-4 py-8">

  <!-- Main slider: its own Splide root -->
  <section class="splide" id="main-splide" aria-label="Gallery">
    <div class="splide__track">
      <ul class="splide__list" id="main-slider">
        <li class="splide__slide">
          <img class="object-cover rounded-md  w-full  aspect-square" src="https://plus.unsplash.com/premium_photo-1761210594096-38d74e09cd26?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1336" alt="Slide 1" />
        </li>
        <li class="splide__slide">
          <img class="object-cover rounded-md  w-full aspect-square" src="https://images.unsplash.com/photo-1761839258671-6495fdc188b3?ixlib=rb-4.1.0&ixid=M3wxMjA3fDF8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1170" alt="Slide 2" />
        </li>
        <li class="splide__slide">
          <img class="object-cover rounded-md  w-full aspect-square" src="https://images.unsplash.com/photo-1762793986911-9451716ac161?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1074" alt="Slide 3" />
        </li>
        <li class="splide__slide">
          <img class="object-cover rounded-md  w-full aspect-square" src="https://plus.unsplash.com/premium_photo-1692640261941-bda4bcb52e1c?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1170" alt="Slide 4" />
        </li>
      </ul>
       
    </div>
 
  </section>

  <!-- Thumbnail slider: separate Splide root for navigation -->
  <section class="splide mt-3" id="thumbnail-splide" aria-label="Gallery thumbnails">
    <div class="splide__track">
      <ul class="splide__list">
        <li class="splide__slide">
          <img class="object-cover  rounded-md w-full  aspect-square" src="https://plus.unsplash.com/premium_photo-1761210594096-38d74e09cd26?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1336" alt="Thumbnail 1" />
        </li>
        <li class="splide__slide">
          <img class="object-cover  rounded-md w-full  aspect-square" src="https://images.unsplash.com/photo-1761839258671-6495fdc188b3?ixlib=rb-4.1.0&ixid=M3wxMjA3fDF8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1170" alt="Thumbnail 2" />
        </li>
        <li class="splide__slide">
          <img class="object-cover  rounded-md w-full  aspect-square" src="https://images.unsplash.com/photo-1762793986911-9451716ac161?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1074" alt="Thumbnail 3" />
        </li>
        <li class="splide__slide">
          <img class="object-cover  rounded-md w-full  aspect-square" src="https://plus.unsplash.com/premium_photo-1692640261941-bda4bcb52e1c?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1170" alt="Thumbnail 4" />
        </li>
      </ul>
    </div>
  </section>

<!-- Detail section below slideshow -->
<section class="details" style="width: 100%;" aria-label="Details">
  <div class="meta">{}</div>
  <h1 class="venue-title">{current ? current.title : 'Activity'}</h1>

  <nav class="tabs" role="tablist" aria-label="Information">
    <button class="tab active" role="tab" aria-selected="true" data-target="description">Description</button>
    <button class="tab " role="tab" aria-selected="false" data-target="menu">Menu</button>
    <button class="tab" role="tab" aria-selected="false" data-target="enhancements">Enhancements</button>
    <button class="tab" role="tab" aria-selected="false" data-target="hour">Operating Hours</button>
    <button class="tab" role="tab" aria-selected="false" data-target="venue">Venue</button>
    
  </nav>

  <div class="tab-panels ">
    <article id="enhancements" class="panel w-full" role="tabpanel" hidden>
      <h2 class="section-title">Enhancements</h2>
      <p>Enhance your visit with these exciting options:</p>
      <ul class="bullets">
        <li>Guided Tour: Explore the park with an expert guide who will share fascinating insights and stories.</li>
        <li>VIP Access: Skip the lines and enjoy priority entry to all attractions.</li>
        <li>Photo Package: Capture your memories with a professional photo package including prints and digital copies.</li>
        <li>Dining Experience: Upgrade to a gourmet meal at one of our exclusive restaurants within the park.</li>
      </ul>
    </article>
    
    <article id="description" class="panel active w-full" role="tabpanel">
      <h2 class="section-title">Highlights</h2>
      <article>
      <p>{current ? current.excerpt : 'Description not available.'}</p>
      </article>

      <hr class="divider" />

    </article>
    <article id="menu" class="panel w-full" role="tabpanel" hidden>
      <h2 class="section-title">Menu</h2>
     <ul>
      <li>
        Special Fried Rice - IDR 35.000
      </li>
      <li>
        Chicken Noodle with Mushroom - IDR 30.000
      </li>
      <li>
        Madura Chicken Satay - IDR 40.000
      </li>
     </ul>
    </article>

    <article id="hour" class="panel w-full" role="tabpanel" hidden>
      <h2 class="section-title">Operating Hours</h2>
      <p>Monday - Friday: 09:00 - 17:00 </p>
      <p>Saturday - Sunday & Public Holidays: 08:00 - 18:00</p>
      <p><em>Note:</em> Hours may change during events or maintenance.</p>
    </article>
    <article id="venue" class="panel w-full" role="tabpanel" hidden>
      <h2 class="section-title">Venue</h2>
      <p>Jawa Timur Park 1 is located at Jalan Kartika No.2, Kota Batu, East Java, Indonesia. It is easily accessible from Malang and Surabaya city centers, making it a popular destination for both local and international visitors.</p>
      <p>On-site facilities include ample parking, a variety of food and beverage options, and souvenir shops selling themed merchandise.</p>
      </article> 

   
  </div>
</section>

<!-- Ticket Selection Section -->
<section class="tickets-section" aria-label="Ticket Options">
    <div class="tickets-container">

      <div class="ticket-list">
        {tickets.map((ticket) => (
          <div class="ticket-card"      data-id={ticket.id}>
            <div class="ticket-content">
              <h3 class="ticket-name">{ticket.name}</h3>
              <p class="ticket-price">From <span class="price-value">{ticket.price}</span></p>
              <button class="detail-toggle" aria-expanded="false">View Details & Included</button>
              <div class="accordion-detail" hidden>
                <ul class="detail-list">
                  {ticket.features.map((f) => (
                    <li>{f}</li>
                  ))}
                </ul>
              </div>
            </div>
            <a href={'/activity/' + Astro.params.id + '/' + ticket.id} class="btn-buy">Select</a>
          </div>
        ))}
      </div>
    </div>
</section>

  </div>


<!-- Client-only scripts: Splide + tab behavior -->
<script type="module">
  import Splide from 'https://cdn.jsdelivr.net/npm/@splidejs/splide@latest/dist/js/splide.esm.min.js';

  document.addEventListener('DOMContentLoaded', () => {
    // Splide init
    try {
var main = new Splide( '#main-splide', {
  type       : 'fade',
  heightRatio: 0.5,
  pagination : false,
  arrows     : true,
  
     padding: '10rem',
  rewind          : true,
} );

var thumbnails = new Splide( '#thumbnail-splide', {
  rewind          : true,
  fixedWidth      : 104,
  fixedHeight     : 58,
  isNavigation    : true,
  arrows          : false,
  gap             : 10,
  focus           : 'center',
  pagination      : false,
  cover           : true,
  dragMinThreshold: {
    mouse: 4,
    touch: 10,
  },
  breakpoints : {
    640: {
      fixedWidth  : 66,
      fixedHeight : 38,
    },
  },
} );

main.sync( thumbnails );
main.mount();
thumbnails.mount();
    } catch (e) {
      console.warn('Splide init failed', e);
    }

    // Tabs behavior
    const tabs = document.querySelectorAll('.tabs .tab');
    const panels = document.querySelectorAll('.tab-panels .panel');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const target = tab.getAttribute('data-target');

        tabs.forEach(t => {
          t.classList.toggle('active', t === tab);
          t.setAttribute('aria-selected', t === tab ? 'true' : 'false');
        });

        panels.forEach(p => {
          if (p.id === target) {
            p.hidden = false;
            p.classList.add('active');
          } else {
            p.hidden = true;
            p.classList.remove('active');
          }
        });
      });
    });

    // Ticket detail toggles
    const toggles = document.querySelectorAll('.detail-toggle');
    toggles.forEach(toggle => {
      toggle.addEventListener('click', (e) => {
        e.preventDefault();
        const card = toggle.closest('.ticket-content');
        const accordion = card.querySelector('.accordion-detail');
        const isExpanded = toggle.getAttribute('aria-expanded') === 'true';
        
        // close other accordions
        document.querySelectorAll('.accordion-detail').forEach(acc => {
          if (acc !== accordion) {
            acc.hidden = true;
            acc.closest('.ticket-content').querySelector('.detail-toggle').setAttribute('aria-expanded', 'false');
            acc.closest('.ticket-content').querySelector('.detail-toggle').textContent = 'View Details & Included';
          }
        });

        // toggle current accordion
        accordion.hidden = !accordion.hidden;
        toggle.setAttribute('aria-expanded', !isExpanded);
        toggle.textContent = !isExpanded ? 'Hide Details' : 'View Details & Included';
      });
    });
  });
</script>

<style>
  /* Details section styles */
  .details {
    max-width: 1200px;
    margin: 24px auto;
    padding: 24px;
    background: #fff;
  }

  .meta {
    font-size: 12px;
    color: #6b7280;
    margin-bottom: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .venue-title {
    margin: 0 0 20px 0;
    font-size: 32px;
    font-weight: 700;
    line-height: 1.1;
    color: #0f172a;
  }

  .tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 24px;
    border-bottom: 1px solid #e5e7eb;
  }

  .tab {
    background: transparent;
    border: none;
    padding: 12px 20px;
    cursor: pointer;
    font-weight: 600;
    color: #6b7280;
    font-size: 14px;
    border-bottom: 3px solid transparent;
    transition: all 0.2s;
    position: relative;
    bottom: -1px;
  }

  /* Make tabs fill the available width and distribute evenly */
  .tabs {
    width: 100%;
  }

  .tab {
    flex: 1 1 0; /* allow each tab to grow equally */
    text-align: center; /* center label */
    padding-left: 12px;
    padding-right: 12px;
  }

  .tab:hover {
    color: #111827;
  }

  .tab.active {
    color: #0f172a;
    border-bottom-color: #0f172a;
    background: transparent;
  }

  .section-title {
    font-size: 18px;
    font-weight: 700;
    margin: 0 0 16px 0;
    color: #0f172a;
    border-bottom: 2px solid #0f172a;
    padding-bottom: 8px;
    display: inline-block;
  }

  .bullets {
    margin: 0 0 20px 20px;
    padding: 0;
    color: #111827;
    list-style-type: disc;
    line-height: 1.6;
  }

  .bullets li {
    margin-bottom: 8px;
  }

  .divider {
    border: none;
    border-top: 1px solid #e5e7eb;
    margin: 20px 0;
  }

  .highlight {
    background: #f9fafb;
    padding: 12px 16px;
    border-left: 4px solid #0f172a;
    margin: 16px 0;
    font-size: 14px;
    line-height: 1.6;
    color: #111827;
  }

  .highlight strong {
    color: #0f172a;
  }

  .more-link {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    margin-top: 12px;
    color: #0f172a;
    text-decoration: none;
    font-weight: 600;
    font-size: 14px;
    border-bottom: 2px solid #e5e7eb;
    padding-bottom: 2px;
    transition: all 0.2s;
  }

  .more-link:hover {
    gap: 8px;
    border-bottom-color: #0f172a;
  }

  /* Tickets Section */
  .tickets-section {
    background: #fff;
    padding: 32px 16px;
    margin-top: 24px;
    border-top: 1px solid #e5e7eb;
  }

  .tickets-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .tickets-title {
    margin: 0 0 24px 0;
    font-size: 24px;
    font-weight: 700;
    color: #0f172a;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .tickets-icon {
    font-size: 28px;
  }

  .ticket-list {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .ticket-card {
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    transition: all 0.2s;
  }

  .ticket-card:hover {
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
    border-color: #d1d5db;
  }

  .ticket-content {
    flex: 1;
  }

  .ticket-name {
    margin: 0 0 8px 0;
    font-size: 16px;
    font-weight: 600;
    color: #0f172a;
  }

  .ticket-price {
    margin: 0 0 8px 0;
    font-size: 14px;
    color: #6b7280;
  }

  .price-value {
    font-weight: 700;
    color: #0f172a;
  }

  .detail-toggle {
    background: transparent;
    border: none;
    padding: 0;
    color: #0f172a;
    font-size: 13px;
    font-weight: 600;
    text-decoration: underline;
    cursor: pointer;
    transition: color 0.2s;
    opacity: 0.7;
  }

  .detail-toggle:hover {
    opacity: 1;
    color: #000;
  }

  .btn-buy {
    background: #0f172a;
    color: #fff;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
    flex-shrink: 0;
    text-decoration: none;
    display: inline-block;
    text-align: center;
  }

  .btn-buy:hover {
    background: #1f2937;
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }

  @media (max-width: 768px) {
    .details {
      padding: 16px;
    }

    .venue-title {
      font-size: 24px;
      margin-bottom: 16px;
    }

    .tabs {
      gap: 4px;
      margin-bottom: 16px;
    }

    .tab {
      padding: 10px 14px;
      font-size: 13px;
    }

    .bullets {
      margin: 0 0 16px 18px;
      font-size: 14px;
    }

    .tickets-section {
      padding: 24px 12px;
    }

    .tickets-title {
      font-size: 20px;
    }

    .ticket-card {
      flex-direction: column;
      align-items: flex-start;
    }

    .btn-buy {
      width: 100%;
    }

    .accordion-detail {
      width: 100%;
    }
  }

  .accordion-detail {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid #e5e7eb;
    animation: slideDown 0.3s ease-out;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .detail-list {
    margin: 0;
    padding: 0;
    list-style: none;
  }

  .detail-list li {
    padding: 6px 0;
    color: #111827;
    font-size: 14px;
    line-height: 1.5;
  }

  .detail-list li::before {
    content: '';
    display: inline-block;
  }
</style>

</Layout>
