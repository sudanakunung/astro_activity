---
import Layout from '../../layouts/Layout.astro';
import "../../styles/global.css";
// Minimal demo data for the cart. Replace with real data or a store as needed.
const cart = [
    {
    id: 'jatim-park-1',
    title: 'Jawa Timur Park 1',
    subtitle: 'Jatim Park 1 + Museum Tubuh + Museum Angkut\nWeekend (Per Pax)',
    qty: 2,
    pricePerPax: 200000,
    date: '29 Nov 2025, 08.30 - 16.30'
    }
];

/** @type {(n:number)=>string} */
const formatCurrency = (n:number) => {
    return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits:0 }).format(Number(n) || 0);
};
---

<Layout>
        <main class="cart-page mx-auto">
            <div class="container mx-auto px-4 py-8">
           
           
                <div class="checkout-grid">
                    <aside class="card summary-card">
                        <div class="summary-header">
                            <h3>My Cart (<span id="cart-count">{cart.length}</span>)</h3>
                            <button class="btn-icon" id="btn-clear" title="Clear cart">üóëÔ∏è</button>
                        </div>

                        <div class="cart-items" id="cart-items">
                            {cart.map(item => (
                                <div class="cart-item" data-id={item.id}>
                                    <div class="item-title">{item.title}</div>
                                    <div class="item-sub">{item.subtitle}</div>
                                    <div class="item-meta">{item.qty} pax X {formatCurrency(item.pricePerPax)}</div>
                                    <div class="item-meta">{item.date}</div>
                                </div>
                            ))}
                        </div>

                        <div class="promo-row">
                            <input type="text" id="promo-code" placeholder="Promo Code" />
                            <button id="apply-promo" class="btn-apply btn-secondary">Claim</button>
                        </div>

                        <div class="summary-total">
                            <div class="total-label">Total</div>
                            <div class="total-value" id="total-value">{formatCurrency(cart.reduce((s,i)=> s + (i.qty * i.pricePerPax), 0))}</div>
                        </div>

                        <div class="summary-actions">
                            <button class="btn-secondary" id="btn-back">Back</button>
                            <button class="btn-buy" id="btn-pay">Payment</button>
                        </div>
                    </aside>
                </div>
            </div>
        </main>

    <script is:inline>
        (function(){
            // Basic interactivity: clear cart and apply promo (UI-only demo)
            const btnClear = document.getElementById('btn-clear');
            btnClear?.addEventListener('click', ()=>{
                const itemsEl = document.getElementById('cart-items');
                if(!itemsEl) return;
                itemsEl.innerHTML = '<div class="empty">Cart is empty.</div>';
                document.getElementById('cart-count').textContent = '0';
                document.getElementById('total-value').textContent = 'IDR 0';
            });

            document.getElementById('apply-promo')?.addEventListener('click', ()=>{
                const codeEl = document.getElementById('promo-code');
                const code = codeEl ? codeEl.value.trim() : '';
                if(!code){ alert('Enter promo code'); return; }
                const totalEl = document.getElementById('total-value');
                if(!totalEl) return;
                const current = parseInt(totalEl.textContent.replace(/\D/g,'')) || 0;
                const discounted = Math.max(0, Math.round(current * 0.9));
                totalEl.textContent = new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits:0 }).format(discounted);
                alert('Promo applied: ' + code);
            });

            document.getElementById('btn-pay')?.addEventListener('click', ()=>{
                alert('Proceed to payment (demo)');
            });

            document.getElementById('btn-back')?.addEventListener('click', ()=>{
                history.back();
            });
        })();
    </script>

    <style>
    .page-title{ font-size:28px; margin:24px 0; }
    /* single column layout: center cart and give comfortable width */
    .checkout-grid{ display:grid; grid-template-columns: 1fr; justify-items:center; }
    .card{ background:#fff; border:1px solid #eee; border-radius:6px; padding:18px; box-shadow:0 1px 0 rgba(0,0,0,0.02); width:100%; max-width:760px;} 
    .summary-card{ width:100%; max-width:760px; }
    .contact-card{ display:none; } /* removed */
    .contact-card input[type="text"], .contact-card input[type="email"], .contact-card input[type="tel"], .summary-card input[type="text"]{ width:100%; padding:12px; border:1px solid #e5e7eb; border-radius:6px; margin:8px 0; }
    .form-field{ display:block; }
    .phone-field{ display:flex; gap:8px; align-items:center; }
    .phone-prefix{ background:#fff; border:1px solid #e5e7eb; padding:10px; border-radius:6px; }
    .form-checkbox{ display:flex; gap:8px; align-items:flex-start; margin-top:12px; font-size:13px; color:#374151; }

    .summary-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
    .summary-header h3{ margin:0; font-size:16px; }
    .btn-icon{ background:transparent; border:none; cursor:pointer; font-size:16px; }

    /* center the list items inside the card */
    .cart-items{
       
        gap: 12px;
        padding: 8px 0;
    }

    .cart-item{
        width: 100%;
        max-width: 680px; /* restrict item width so it's centered inside the card */
        padding: 12px 16px;
        border-top:1px solid #f3f4f6;
        box-sizing: border-box;
        text-align: center; /* center text */
        margin: 0 auto;
    }
    .cart-item:first-child{ border-top:none; }
    .item-title{ font-weight:700; color:#0f172a;text-align: left; }
    .item-sub{ color:#6b7280; white-space:pre-line; margin:6px 0;text-align: left; }
    .item-meta{ color:#6b7280; font-size:13px;text-align: left; }

    .promo-row{ display:flex; gap:8px; margin:14px 0; width:100%; justify-content:center;align-items: center; }
    .promo-row input{ flex:1; padding:10px; border:1px solid #e5e7eb; border-radius:6px; max-width:420px; }
    .btn-apply{ padding:10px 14px; border-radius:6px; cursor:pointer; border:1px solid #e5e7eb; background:#fff; }
    .btn-apply.small{ padding:8px 12px; font-size:13px; }

    .summary-total{ display:flex; justify-content:space-between; align-items:center; padding-top:12px; border-top:1px solid #f3f4f6; margin-top:8px; }
    .total-label{ font-weight:700; font-size:18px; }
    .total-value{ font-weight:800; font-size:18px; }
    .total-value .price-value{ font-weight:800; }

    .summary-actions{ display:flex; gap:12px; justify-content:flex-end; margin-top:18px; }
    /* primary (dark) */
    .btn-buy{ background:#0f172a; color:#fff; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:700; }
    .btn-buy:hover{ background:#111827; }

    /* secondary (outline) */
    .btn-secondary{ background:#fff; color:#0f172a; border:1px solid #e5e7eb; padding:10px 18px; border-radius:6px; cursor:pointer; font-weight:600; }
    .btn-secondary:hover{ background:#f9fafb; }

    @media (max-width: 900px){
        .checkout-grid{ grid-template-columns: 1fr; padding: 0 12px; }
        .summary-card{ order: -1; max-width:100%; }
        .promo-row{ flex-direction:column; align-items:center; }
        .promo-row input{ max-width:100%; }
    }
</style>

</Layout>

